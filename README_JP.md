# Python 画面キャプチャ自動化ツール  
[English version → README.md](./README.md)

## 概要
このプロジェクトは、**キーボード操作で画面を切り替えられる任意のアプリケーション**から、連続的に画面内容を自動キャプチャするための Python ツールです。  
取得した画像を **1つのPDF** または **章ごとの複数PDF** にまとめることができます。

本ツールは以下の2つのスクリプトで構成されています。
- **capture.py** ? ページごとに画面を自動キャプチャします。
- **merge.py** ? キャプチャした画像をトリミングし、PDFとして結合します。

---

## 特徴
- 設定したホットキーで画面を自動キャプチャ。
- 読み込み遅延やトリミング範囲を柔軟に設定可能。
- 出力画像を章ごと、または全体をまとめてPDF化。
- トリミング・結合・PDF生成時の進行状況バーを表示可能。
- **uv** による Python パッケージ管理を採用。

---

## セットアップ

### 1. [uv](https://github.com/astral-sh/uv) のインストール
このプロジェクトでは Python の依存関係管理に `uv` を使用しています。

```bash
pip install uv
```

### 2. 依存パッケージのインストール
プロジェクトディレクトリで以下を実行します。
```bash
uv sync
```
これにより、仮想環境が作成され、`pyproject.toml` に記載された必要なライブラリが自動的にインストールされます。
```
img2pdf, pillow, pyautogui, pygetwindow, pypdf, tqdm
```

---

## 使い方

### 1. 画像キャプチャ
**capture.py** の設定を編集し、キャプチャ対象のウィンドウタイトルやホットキーを指定します。

実行コマンド:
```bash
uv run capture.py
```

このスクリプトは以下を実行します:
- 指定したウィンドウをアクティブ化（可能な場合）
- 矢印キーまたはPageDownキーでページを切り替え
- 各ページのスクリーンショットを `outputs/` フォルダに保存

実行中は `Ctrl + C` で安全に停止できます。

---

### 2. PDFへの結合
全ページのキャプチャ完了後、**merge.py** の設定でページ範囲やトリミング設定を指定します。

実行コマンド:
```bash
uv run merge.py
```

このスクリプトは以下を実行します:
- 画像をトリミング（有効時）
- 範囲ごとの章PDFを作成（任意）
- 全ページをまとめた最終PDFを `pdf_out/` に出力

---

## ディレクトリ構成
```
python-ebook-capturer/
│
├── capture.py           # 画面キャプチャ自動化スクリプト
├── merge.py             # PDF結合・トリミングスクリプト
├── pyproject.toml       # プロジェクト設定と依存関係
├── outputs/             # キャプチャ画像の保存先（自動生成）
└── pdf_out/             # PDF出力フォルダ（自動生成）
```

---

## 注意事項
- 矢印キーでページ送りが可能なアプリケーションであれば利用できます。
- `capture.py` の `delay_after_flip` を調整することで、画面の読み込み完了を待ってからキャプチャ可能です。
- 一時的に生成されるトリミング済み画像は、処理完了後に自動削除されます。
